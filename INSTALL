#!/bin/bash

## if console font is unreadably small
# cd /usr/share/consolefonts/
# setfont Lat15-Terminus32x16.psf.gz

## to temporarily attach to wifi
# ip a
# wpa_passphrase <ssid> <pwd> > /etc/wpa_supplicant/wpa_supplicant.conf
# /sbin/wpa_supplicant -i<interface> -c/etc/wpa_supplicant/wpa_supplicant.conf -d &

unset  LANGUAGE
unset  LC_CTYPE
LANG="$(locale -a | grep -Ei "en.us.utf")"

# get man√®t stuff
[ ! -e ~/.git ] &&
    cd /tmp &&
    rm -rf dotfiles &&
    git clone https://git.sr.ht/~massemanet/dotfiles dotfiles &&
    cd dotfiles &&
    git remote set-url origin git@git.sr.ht:~massemanet/dotfiles &&
    mv .git ~ &&
    cd ~ &&
    git reset --hard &&
    git checkout trunk

# init emacs
command -v emacs &&
    [ -f ~/.config/emacs/init.el ] &&
    emacs --batch --eval "(require 'init (expand-file-name \"init.el\" user-emacs-directory))"

# move otp out of the way
[ -d ~/.config/emacs/straight/repos/otp ] &&
    [ ! -L ~/.config/emacs/straight/repos/otp ] &&
    mv ~/.config/emacs/straight/repos/otp ~/git &&
    ln -s ~/git/otp ~/.config/emacs/straight/repos

# the end
exit 0
